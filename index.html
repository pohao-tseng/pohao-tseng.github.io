<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>PO-HAO TSENG | 意義場</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <style>
        :root {
            --bg-color: #050505;
            --text-color: #e0e0e0;
            --accent-color: #888;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: var(--bg-color);
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            color: var(--text-color);
            -webkit-tap-highlight-color: transparent; /* 移除手機點擊高亮 */
        }

        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        #ui-layer {
            position: relative;
            z-index: 10;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .interactive {
            pointer-events: auto;
        }

        /* --- Landing Screen --- */
        #landing-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(5,5,5,0.85);
            transition: opacity 1.5s ease;
            z-index: 20;
        }

        h1 {
            font-weight: 300;
            letter-spacing: 8px;
            font-size: 1.5rem;
            margin-bottom: 2rem;
            text-transform: uppercase;
            text-shadow: 0 0 15px rgba(255,255,255,0.3);
            text-align: center;
        }

        #enter-btn {
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.4);
            color: #fff;
            padding: 15px 50px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 3px;
        }

        #enter-btn:active, #enter-btn:hover {
            background: rgba(255,255,255,0.25);
            box-shadow: 0 0 25px rgba(255,255,255,0.3);
        }

        /* --- Navigation --- */
        nav {
            position: absolute;
            bottom: 40px;
            left: 50px;
            display: flex;
            gap: 40px;
            opacity: 0;
            transform: translateY(20px);
            z-index: 30;
        }

        .nav-link {
            text-decoration: none;
            color: #777;
            font-size: 0.9rem;
            letter-spacing: 1.5px;
            cursor: pointer;
            transition: color 0.3s, text-shadow 0.3s;
            padding: 10px 0;
        }

        .nav-link:hover, .nav-link.active {
            color: #fff;
            text-shadow: 0 0 10px rgba(255,255,255,0.6);
            border-bottom: 1px solid #fff;
        }

        /* --- Content Layout --- */
        .content-section {
            position: absolute;
            top: 0;
            right: 0;
            width: 50%;
            height: 100%;
            background: linear-gradient(to left, rgba(0,0,0,0.95) 20%, rgba(0,0,0,0.8) 100%);
            display: none;
            opacity: 0;
            padding: 80px 60px;
            box-sizing: border-box;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch; /* iOS 滾動優化 */
        }
        
        .content-section.active {
            display: block;
        }

        /* 隱藏捲軸但保留功能 */
        .content-section::-webkit-scrollbar {
            width: 6px;
        }
        .content-section::-webkit-scrollbar-thumb {
            background: #444; 
            border-radius: 3px;
        }

        .text-block {
            margin-top: 60px;
            margin-bottom: 100px;
        }

        .text-block h2 {
            font-weight: 200;
            font-size: 2rem;
            margin-bottom: 40px;
            border-bottom: 1px solid #555;
            padding-bottom: 15px;
            color: #fff;
            letter-spacing: 2px;
        }

        .text-block h3 {
            font-weight: 400;
            font-size: 1.2rem;
            color: #ddd;
            margin-top: 40px;
            margin-bottom: 20px;
            letter-spacing: 1px;
            border-left: 3px solid #888;
            padding-left: 10px;
        }

        .text-block p {
            line-height: 1.7;
            font-size: 0.95rem;
            color: #ccc;
            margin-bottom: 15px;
            text-align: justify;
        }

        /* --- Timeline Style for Experience --- */
        .timeline-item {
            position: relative;
            padding-left: 20px;
            margin-bottom: 25px;
            border-left: 1px solid #444;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -4px;
            top: 6px;
            width: 7px;
            height: 7px;
            background: #888;
            border-radius: 50%;
        }
        .year {
            font-size: 0.85rem;
            color: #888;
            font-family: monospace;
            margin-bottom: 5px;
            display: block;
        }
        .job-title {
            font-size: 1rem;
            color: #fff;
            font-weight: 500;
        }
        .job-desc {
            font-size: 0.85rem;
            color: #aaa;
        }

        /* --- Social Buttons --- */
        .social-links {
            margin-top: 30px;
            display: flex;
            gap: 15px;
        }
        .social-btn {
            display: inline-block;
            padding: 8px 20px;
            border: 1px solid #666;
            color: #ccc;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.3s;
            border-radius: 2px;
        }
        .social-btn:hover {
            border-color: #fff;
            color: #fff;
            background: rgba(255,255,255,0.1);
        }

        /* --- Mobile Responsive --- */
        @media (max-width: 768px) {
            .content-section {
                width: 100%;
                background: rgba(5,5,5,0.92);
                padding: 30px;
                padding-top: 80px; /* 避開頂部 */
            }
            
            nav {
                bottom: 0;
                left: 0;
                width: 100%;
                background: rgba(10,10,10,0.95);
                padding: 15px 0;
                justify-content: center;
                gap: 30px;
                border-top: 1px solid #333;
            }

            .nav-link {
                font-size: 0.8rem;
                padding: 5px;
            }

            h1 { font-size: 1.2rem; letter-spacing: 5px; }
            .text-block h2 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>

    <div id="canvas-container"></div>

    <div id="ui-layer">
        
        <div id="landing-screen" class="interactive">
            <h1>PO-HAO TSENG</h1>
            <button id="enter-btn">ENTER MEANING FIELD</button>
            <p id="audio-status" style="margin-top: 15px; font-size: 0.7rem; color: #555;">Headphones Recommended</p>
        </div>

        <nav id="main-nav" class="interactive">
            <a class="nav-link" onclick="navigateTo('about')">ABOUT</a>
            <a class="nav-link" onclick="navigateTo('experiences')">EXPERIENCES</a>
            <a class="nav-link" onclick="navigateTo('gallery')">GALLERY</a>
        </nav>

        <div id="about" class="content-section interactive">
            <div class="text-block">
                <h2>關於 / About</h2>
                
                <h3>簡介 Introduction</h3>
                <p>台北藝術大學藝術跨域研究所畢。從小學習中國音樂，而後曾師承周定邦先生學習台灣唸歌。</p>
                <p>2012年與友人創立《迷宮迴廊》樂團，2013年參與《小嫩豬》樂團。2014年創立鬼講堂，與表演者吳宗恩、戴開成共創改編焦吧哖事件。2018年於臺北和鳴南樂社學習南管。</p>
                <p>近年常參與劇場與聲音相關創作，曾與各國藝術家：Kitt Johnson（丹麥）、坂本弘道、內橋和久、千野秀一、李世揚、李慈湄、黃思農等人合作或即興音樂交流。</p>
                <p>近來在音樂間流浪以及嘗試理解何謂「在當場」，除鬼講堂計畫試圖理解抗日事件中的多重敘事問題及背後社會成因外，音樂作品則與社會議題及個人情感相關。</p>

                <h3>專注領域 Focus</h3>
                <p>演奏、歌唱、詞曲創作、唸歌創作演唱、藝術創作、藝術理論</p>

                <h3>聯絡 Contact</h3>
                <p>Email: jerry801022@gmail.com</p>
                <p>Phone: +886 988 463 036</p>
                
                <div class="social-links">
                    <a href="https://www.facebook.com/share/1ATPLBnGpg/?mibextid=wwXIfr" target="_blank" class="social-btn">Facebook</a>
                    <a href="https://www.instagram.com/po_hao_tseng?igsh=MTV2dXFiODZwZW4wYg%3D%3D&utm_source=qr" target="_blank" class="social-btn">Instagram</a>
                </div>
            </div>
        </div>

        <div id="experiences" class="content-section interactive">
            <div class="text-block">
                <h2>經歷 / Experience</h2>

                <h3>Education 學歷</h3>
                <div class="timeline-item">
                    <span class="year">Present</span>
                    <div class="job-title">台北藝術大學 藝術跨領域研究所 (MFA)</div>
                    <div class="job-desc">Taipei University of the Arts</div>
                </div>
                <div class="timeline-item">
                    <span class="year">2010 - 2015</span>
                    <div class="job-title">台南藝術大學 材質創作與設計系 (BA)</div>
                    <div class="job-desc">Tainan University of the Arts</div>
                </div>

                <h3>Current Position 現職</h3>
                <div class="timeline-item">
                    <span class="year">Now</span>
                    <div class="job-title">藝術、音樂、劇場相關工作者</div>
                </div>
                <div class="timeline-item">
                    <span class="year">Now</span>
                    <div class="job-title">《小嫩豬》樂團樂手</div>
                    <div class="job-desc">Bandsman of Little Sexy Young Pig Band</div>
                </div>
                <div class="timeline-item">
                    <span class="year">Now</span>
                    <div class="job-title">《鬼講堂》計劃人</div>
                    <div class="job-desc">Organizer of Lecture Of Ghost</div>
                </div>

                <h3>Live Performances 個人創作演出</h3>
                <div class="timeline-item">
                    <span class="year">2020</span>
                    <div class="job-title">漫遊者劇場《池子》</div>
                    <div class="job-desc">臺灣大學水源校區，臺北</div>
                </div>
                <div class="timeline-item">
                    <span class="year">2019</span>
                    <div class="job-title">《落對話-譯○》聲音劇場</div>
                    <div class="job-desc">空總創新基地，臺北</div>
                </div>
                <div class="timeline-item">
                    <span class="year">2017</span>
                    <div class="job-title">《日日新微型表演行動》</div>
                    <div class="job-desc">太原五百完人塚，台北</div>
                </div>
                <div class="timeline-item">
                    <span class="year">2015</span>
                    <div class="job-title">《中國城藝術行動》</div>
                    <div class="job-desc">《運河無崁蓋》演出，台南</div>
                </div>

                <h3>鬼講堂 Lecture of Ghost</h3>
                <div class="timeline-item">
                    <span class="year">2016</span>
                    <div class="job-title">台北雙年展《當下檔案・未來系譜》</div>
                    <div class="job-desc">鬼講堂第二講演出，紀州庵文學森林</div>
                </div>
                <div class="timeline-item">
                    <span class="year">2016</span>
                    <div class="job-title">大稻埕國際藝術節《鬼話練習曲》</div>
                    <div class="job-desc">讀劇演出，衣戲院，台北</div>
                </div>
                <div class="timeline-item">
                    <span class="year">2015</span>
                    <div class="job-title">大稻埕國際藝術節《鬼講堂第一講》</div>
                    <div class="job-desc">小酒趴，台北</div>
                </div>

                <h3>Awards 獎項</h3>
                <div class="timeline-item">
                    <span class="year">2019</span>
                    <div class="job-title">台新藝術獎 年度大獎</div>
                    <div class="job-desc">《明白歌-未竟的故人事》再拒劇團 (參與音樂設計、演員)</div>
                </div>
                <div class="timeline-item">
                    <span class="year">2012</span>
                    <div class="job-title">南面而歌 原創歌曲 評審推薦獎</div>
                    <div class="job-desc">作品《連根拔起》</div>
                </div>

                <h3>Collaborations 合作</h3>
                <div class="timeline-item">
                    <span class="year">2021</span>
                    <div class="job-title">《島遊情書》文學配音及音樂設計</div>
                    <div class="job-desc">臺灣歷史博物館</div>
                </div>
                <div class="timeline-item">
                    <span class="year">2019</span>
                    <div class="job-title">《層中隙》表演藝術現地製作</div>
                    <div class="job-desc">與丹麥藝術家 Kitt Johnson 合作，臺南</div>
                </div>
                
                <p style="margin-top:30px; font-size:0.8rem; color:#666;">(更多經歷詳見完整版履歷)</p>
            </div>
        </div>

        <div id="gallery" class="content-section interactive">
            <div class="text-block">
                <h2>作品 / Gallery</h2>
                <p>影像載入中...</p>
            </div>
        </div>

    </div>

    <script>
        let scene, camera, renderer, clock;
        let bgParticles, fgParticles, linesMesh;
        let mouse = new THREE.Vector2(9999, 9999); // 預設在畫面外
        let raycaster;
        let sound, analyser;
        let isAudioActive = false;
        let pulseFactor = 1;

        // 設定參數
        const BG_COUNT = 3000;
        const FG_COUNT = 600;
        const CONNECT_DIST = 70;
        const MOUSE_RADIUS = 250;

        init();
        animate();

        function init() {
            const container = document.getElementById('canvas-container');
            clock = new THREE.Clock();

            // 1. Scene & Camera
            scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x050505, 0.001);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 3000);
            camera.position.z = 600;

            // 2. Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio); // 支援 Retina
            container.appendChild(renderer.domElement);

            // 3. Texture
            const sprite = createGlowSprite();

            // 4. Background Mist
            const bgGeo = new THREE.BufferGeometry();
            const bgPos = [];
            for (let i = 0; i < BG_COUNT; i++) {
                const x = (Math.random() - 0.5) * 3000;
                const y = (Math.random() - 0.5) * 2000;
                const z = (Math.random() - 0.5) * 2000 - 500;
                bgPos.push(x, y, z);
            }
            bgGeo.setAttribute('position', new THREE.Float32BufferAttribute(bgPos, 3));
            const bgMat = new THREE.PointsMaterial({
                color: 0x888888, size: 8, map: sprite,
                transparent: true, opacity: 0.2, blending: THREE.AdditiveBlending, depthWrite: false
            });
            bgParticles = new THREE.Points(bgGeo, bgMat);
            scene.add(bgParticles);

            // 5. Foreground Neurons
            const fgGeo = new THREE.BufferGeometry();
            const fgPos = [];
            const fgVel = [];
            for (let i = 0; i < FG_COUNT; i++) {
                const x = (Math.random() - 0.5) * 1200;
                const y = (Math.random() - 0.5) * 900;
                const z = (Math.random() - 0.5) * 600;
                fgPos.push(x, y, z);
                fgVel.push({
                    x: (Math.random() - 0.5) * 0.4,
                    y: (Math.random() - 0.5) * 0.4,
                    z: (Math.random() - 0.5) * 0.4
                });
            }
            fgGeo.setAttribute('position', new THREE.Float32BufferAttribute(fgPos, 3));
            const fgMat = new THREE.PointsMaterial({
                color: 0xffffff, size: 5, map: sprite,
                transparent: true, opacity: 0.9, blending: THREE.AdditiveBlending, depthWrite: false
            });
            fgParticles = new THREE.Points(fgGeo, fgMat);
            fgParticles.userData = { velocity: fgVel };
            scene.add(fgParticles);

            // 6. Line System
            const lineGeo = new THREE.BufferGeometry();
            const linePos = new Float32Array(FG_COUNT * 2 * 3 * 2); // Buffer size
            lineGeo.setAttribute('position', new THREE.BufferAttribute(linePos, 3));
            const lineMat = new THREE.LineBasicMaterial({
                color: 0xffffff, transparent: true, opacity: 0.3, blending: THREE.AdditiveBlending
            });
            linesMesh = new THREE.LineSegments(lineGeo, lineMat);
            scene.add(linesMesh);

            // 7. Events (Mouse + Touch)
            raycaster = new THREE.Raycaster();
            
            // 電腦滑鼠
            document.addEventListener('mousemove', onMouseMove, false);
            
            // 手機觸控 (關鍵修正)
            document.addEventListener('touchmove', onTouchMove, { passive: false });
            document.addEventListener('touchstart', onTouchMove, { passive: false });
            
            window.addEventListener('resize', onResize, false);
        }

        // 觸控事件處理
        function onTouchMove(e) {
            // 防止捲動 (如果是多指觸控則允許)
            if(e.touches.length === 1) {
                // e.preventDefault(); // 如果需要鎖死背景可打開
                const touch = e.touches[0];
                mouse.x = (touch.clientX / window.innerWidth) * 2 - 1;
                mouse.y = -(touch.clientY / window.innerHeight) * 2 + 1;
            }
        }

        function onMouseMove(e) {
            mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
        }

        function createGlowSprite() {
            const canvas = document.createElement('canvas');
            canvas.width = 64; canvas.height = 64;
            const ctx = canvas.getContext('2d');
            const g = ctx.createRadialGradient(32,32,0, 32,32,32);
            g.addColorStop(0, 'rgba(255,255,255,1)');
            g.addColorStop(0.3, 'rgba(255,255,255,0.4)');
            g.addColorStop(1, 'rgba(0,0,0,0)');
            ctx.fillStyle = g; ctx.fillRect(0,0,64,64);
            return new THREE.CanvasTexture(canvas);
        }

        function initAudio() {
            // 手機播放關鍵：必須在使用者點擊事件中建立 AudioContext
            const listener = new THREE.AudioListener();
            camera.add(listener);
            sound = new THREE.Audio(listener);
            
            const loader = new THREE.AudioLoader();
            document.getElementById('audio-status').innerText = "Loading Audio...";
            
            loader.load('bgm.mp3', 
                function(buffer) {
                    sound.setBuffer(buffer);
                    sound.setLoop(true);
                    sound.setVolume(0.8);
                    // 確保 AudioContext 是 resume 狀態
                    if (listener.context.state === 'suspended') {
                        listener.context.resume();
                    }
                    sound.play();
                    analyser = new THREE.AudioAnalyser(sound, 32);
                    isAudioActive = true;
                    document.getElementById('audio-status').innerText = "Playing";
                },
                undefined,
                function(err) {
                    console.log("Audio load error:", err);
                    document.getElementById('audio-status').innerText = "Visual Mode";
                }
            );
        }

        function animate() {
            requestAnimationFrame(animate);
            const time = clock.getElapsedTime();

            // Audio Analysis
            if (isAudioActive && analyser) {
                const data = analyser.getAverageFrequency();
                pulseFactor = 1 + (data / 256) * 0.6; 
            } else {
                pulseFactor = 1 + Math.sin(time * 2) * 0.1;
            }

            // Animation
            bgParticles.rotation.y = time * 0.05;
            bgParticles.material.opacity = 0.2 * pulseFactor;

            const positions = fgParticles.geometry.attributes.position.array;
            const velocities = fgParticles.userData.velocity;

            for(let i=0; i<FG_COUNT; i++) {
                const ix = i*3;
                positions[ix] += velocities[i].x * pulseFactor;
                positions[ix+1] += velocities[i].y * pulseFactor;
                positions[ix+2] += velocities[i].z * pulseFactor;
                
                // Wrap around
                if(positions[ix]>600) positions[ix]=-600;
                if(positions[ix]<-600) positions[ix]=600;
                if(positions[ix+1]>500) positions[ix+1]=-500;
                if(positions[ix+1]<-500) positions[ix+1]=500;
            }
            fgParticles.geometry.attributes.position.needsUpdate = true;

            // Connections
            raycaster.setFromCamera(mouse, camera);
            const targetPos = new THREE.Vector3();
            
            // 處理滑鼠投影點
            const vec = new THREE.Vector3(mouse.x, mouse.y, 0.5);
            vec.unproject(camera);
            const dir = vec.sub(camera.position).normalize();
            const dist = -camera.position.z / dir.z;
            targetPos.copy(camera.position).add(dir.multiplyScalar(dist));

            let vertexIndex = 0;
            const linePositions = linesMesh.geometry.attributes.position.array;
            const p1 = new THREE.Vector3();
            const p2 = new THREE.Vector3();
            const activeRadius = MOUSE_RADIUS * pulseFactor;

            for (let i = 0; i < FG_COUNT; i++) {
                p1.set(positions[i*3], positions[i*3+1], positions[i*3+2]);
                if (p1.distanceTo(targetPos) < activeRadius) {
                    for (let j = i + 1; j < FG_COUNT; j++) {
                        p2.set(positions[j*3], positions[j*3+1], positions[j*3+2]);
                        if (p1.distanceTo(p2) < CONNECT_DIST) {
                            linePositions[vertexIndex++] = p1.x;
                            linePositions[vertexIndex++] = p1.y;
                            linePositions[vertexIndex++] = p1.z;
                            linePositions[vertexIndex++] = p2.x;
                            linePositions[vertexIndex++] = p2.y;
                            linePositions[vertexIndex++] = p2.z;
                            if(vertexIndex >= linePositions.length) break;
                        }
                    }
                }
            }
            linesMesh.geometry.setDrawRange(0, vertexIndex / 3);
            linesMesh.geometry.attributes.position.needsUpdate = true;
            linesMesh.material.opacity = 0.3 * pulseFactor;

            renderer.render(scene, camera);
        }

        function onResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // Navigation
        document.getElementById('enter-btn').addEventListener('click', () => {
            initAudio();
            gsap.to('#landing-screen', { duration: 1.5, opacity: 0, pointerEvents: 'none' });
            gsap.to('nav', { duration: 1, opacity: 1, y: 0, delay: 0.5 });
            gsap.to(camera.position, { duration: 2.5, z: 400, ease: "power2.inOut" });
        });

        window.navigateTo = function(id) {
            document.querySelectorAll('.content-section').forEach(el => {
                el.classList.remove('active');
                gsap.to(el, { opacity: 0, duration: 0.5 });
            });
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active'); // 手機觸控有時不會觸發 hover，需要強制加 class

            const target = document.getElementById(id);
            if(target) {
                target.classList.add('active');
                gsap.to(target, { opacity: 1, duration: 1, delay: 0.5 });
                target.scrollTop = 0; // 切換頁面時回到頂部
            }
        }
    </script>
</body>
</html>
